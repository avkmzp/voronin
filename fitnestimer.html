<!DOCTYPE html>
<html lang="ru-RU">
<head>
    <meta charset="UTF-8">
    <title>Тренировочная зона</title>
    <link rel="stylesheet" href="styles/style_login.css">
    <link rel="icon" href="favicon.ico">
    <script src="scripts/NoSleep.js"></script>
    <script>
        var noSleep = new NoSleep();
        var noSleepPresnt = false;

        function enableNoSleep() {
            if (!noSleepPresnt) {
                noSleep.enable();
                document.getElementById('sleep').style.color = 'yellow';
                document.getElementById('sleep').style.backgroundColor = 'blue';
                document.getElementById('sleep').innerHTML = '☀';
                noSleepPresnt = true;
            } else {
                noSleep.disable();
                document.getElementById('sleep').style.color = 'aliceblue';
                document.getElementById('sleep').style.backgroundColor = 'darkslategrey';
                document.getElementById('sleep').innerHTML = '☽';
                noSleepPresnt = false;
            }
        }

        var sekund = 120;
        var interval = 5;
        var count = '1';
        var rejim = ['Сила', 'Гибкость', 'Удержание'];
        var pause = false;
        var start = false;
        var context = new window.AudioContext();

        function startTimer() {
            if (start) {
                clearInterval(idTimer);
                start = false;
                sekund = 120;
                count = 1;
                document.getElementById('time').innerHTML = 120;
                document.getElementById('count').innerHTML = 0;
                document.getElementById('start').value = "Старт";
                return;
            }
            start = true;
            pause = false;
            document.getElementById('start').value = "Сброс";
            setTimeout(function () {

            }, 5000);

            idTimer = setInterval(function () {
                if (!pause) {
                    sekund--;
                }
                if (sekund < 0) {
                    sekund = 120;
                    count++;
                }
                document.getElementById('time').innerHTML = sekund;
                document.getElementById('count').innerHTML = count;
                if ((sekund % 5 == 0) && (!pause) && sekund != 0 && sekund < 120) {
                    teek();
                }
                if (sekund == 120) {
                    peek();
                }

            }, 1000)
        }

        function pauseTimer() {
            if (pause) {
                document.getElementById('pause').value = "Пауза";
                pause = false;
            }
            else {
                document.getElementById('pause').value = "Продолжить";
                pause = true;
            }
        }

        function peek() {
            var oscillator = context.createOscillator();
            var now = context.currentTime;
            oscillator.type = 'sine';
            oscillator.frequency.value = 500;
            oscillator.connect(context.destination);
            oscillator.start(now);
            oscillator.stop(now + 1);
        }

        function teek() {
            var oscillator = context.createOscillator();
            var now = context.currentTime;
            oscillator.type = 'sine';
            oscillator.frequency.value = 440;
            oscillator.connect(context.destination);
            oscillator.start(now);
            oscillator.stop(now + 0.2);
        }
    </script>
</head>
<body>
<div>
    <div id="sleep" onclick="enableNoSleep()">
        ☽
    </div>
    <div id="time">
        120
    </div>
    <div id="count">
        0
    </div>
    <input id='start' value="Старт" type="button" onclick="startTimer()">
    <input id='pause' value="Пауза" type="button" onclick="pauseTimer()">
    <!--<input id='setting' type="button">-->
</div>
</body>
<script>
//    document.getElementById('setting').value = rejim[0];
</script>
</html>